/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

plugins {
    id "com.github.node-gradle.node" version "2.2.4"
}

apply plugin: 'base'

node {
    version = '12.19.0'
    download = true
}


// task makePretty() {
//     println('makePretty:___________>>>>>>\t')
//     // delete 'uglyFolder', 'uglyFile'
//     // //   followSymlinks = true
//     // fileTree('.').each { println it ; }
//     doFirst {
//         println('makePretty:___________ DO FIRST')
//     }
// }

task deleteNodeModules(type: Delete) {
    println('deleteNodeModules:___________>>>>>>\t')

    doFirst {
        println('deleteNodeModules:___________ DO FIRST')

    }
    delete "$rootDir/node-module/node_modules"
    delete "$rootDir/node-module/package-lock.json"
}

task makeZipOfNodeModule(type: Zip) {
    println('makeZipOfNodeModule:___________>>>>>>\t')
   
    archiveName 'node-module.zip'
    from "$rootDir/node-module"
    include '*'
    include '*/*'
    exclude '*gradle*'
    exclude '**/build'
    // destinationDir(file("$rootDir/zip"))
}

tasks.clean.dependsOn tasks.deleteNodeModules

tasks.assemble.dependsOn tasks.makeZipOfNodeModule
tasks.makeZipOfNodeModule.dependsOn tasks.npmInstall
tasks.npmInstall.dependsOn tasks.nodeSetup
